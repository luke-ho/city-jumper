<!DOCTYPE html>
<html>
<head>
    <title>City Jumper</title>
    <link rel="shortcut icon" href="img/city_jumper.ico"/>
    <style>
        html{font-family:"Helvetica Neue";font-size:16px}
        div.background{background-color:#000;opacity:1;width:100%;height:auto;bottom:0;top:0;left:0;z-index:-99;position:absolute;background-attachment:fixed;background-position:center;background-repeat:no-repeat}
        div.background_overlay{background-color:#000;opacity:0;width:100%;height:auto;bottom:0;top:0;left:0;position:absolute;z-index:-50}
        div.error{position:absolute;opacity:0;top:25%;left:28%;z-index:2}
        div.page{background-color:transparent;opacity:1;width:100%;height:auto;bottom:0;top:0;left:0;position:absolute;background-attachment:fixed;background-position:center;background-repeat:no-repeat}
        div.center{position:absolute;top:41%;left:38%;z-index:2}
        div.center_button{position:absolute;top:61%;left:47.6%;z-index:1}
        div.footer{position:absolute;top:92%;left:28%;z-index:2}
        div.pagestats{position:absolute;top:20%;left:48%}
        div.mousestats{position:absolute;top:20%;left:47%}
        p.error{color:red;text-align:center}
        p.stats,a.attributes{color:#DDE3f4;text-align:center}
    </style>
    <style>
         .typeahead,.tt-query,.tt-hint{width:300px;height:30px;font-size:24px;line-height:30px;border:2px solid #ccc;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;outline:none;color:#fff;padding:8px 12px}
        .typeahead{background-color:transparent}
        .typeahead:focus{border:2px solid #0097cf}
        .tt-query{-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);-moz-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}
        .tt-hint{color:#999}
        .tt-dropdown-menu{width:300px;margin-top:12px;background-color:#000;border:1px solid rgba(0,0,0,0.2);-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;-webkit-box-shadow:0 5px 10px rgba(0,0,0,.2);-moz-box-shadow:0 5px 10px rgba(0,0,0,.2);box-shadow:0 5px 10px rgba(0,0,0,.2);padding:8px 12px}
        .tt-suggestion{font-size:18px;line-height:24px;color:#DDE3f4;padding:3px 20px}
        .tt-suggestion.tt-is-under-cursor{color:#fff;background-color:#0097cf}
        .tt-suggestion p{margin:0}
        .gist{font-size:14px}
    </style>
</head>
<body>  
    <div class="background"></div> 
    <div class="background_overlay"></div>
    <div class="resizer"></div>
    <div class="page">
        <noscript> Enable JavaScript to see the content on this page.</noscript>
        <div class="content">
            <div class="stats">
            </div>
            <div class="error">
            </div>
            <div class="mousestats">
            </div>
            <div class="center">
                <input class="typeahead" type="text" placeholder="City?">
            </div>
            <div class="center_button">
                <button id="random_button" type="button">Pick for Me!</button>
                <button id="next_image_button" type="button">Next Image</button>
            </div>
            <div class="footer">
            </div>
        </div>    
    </div>
</body>
<script src="js/jquery.min.js"></script>
<script src="js/typeahead.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){function g(t,n){var r=$("div.page").width();var i=$("div.page").height();var s=0;$.getJSON("http://api.flickr.com/services/rest/?method=flickr.photos.getSizes&nojsoncallback=1",{api_key:e,photo_id:t,format:"json"}).done(function(e){var t=e.sizes.size.length-1;s=e.sizes.size[e.sizes.size.length-1].source;v=new Image;v.src=s})}function y(t,n){var r=$("div.page").width();var i=$("div.page").height();var o=0;$.getJSON("http://api.flickr.com/services/rest/?method=flickr.photos.getSizes&nojsoncallback=1",{api_key:e,photo_id:t,format:"json"}).done(function(e){var t=e.sizes.size.length-1;o=e.sizes.size[e.sizes.size.length-1].source;if(s==false){$("div.background_overlay").animate({opacity:1},1e4,function(){$("div.background").css("background-image","url("+o+")");$("div.footer").empty();$("div.footer").append('<a href="'+e.sizes.size[t].url+'" target="_blank" class="attributes">'+e.sizes.size[t].url+"</a>");L()});$("div.background_overlay").animate({opacity:0},1e4,function(){})}else{$("div.background").css("background-image","url("+o+")");$("div.background_overlay").animate({opacity:0},2e3);$("div.footer").empty();$("div.footer").append('<a href="'+e.sizes.size[t].url+'" target="_blank" class="attributes">'+e.sizes.size[t].url+"</a>");L();s=false}})}function b(){clearTimeout(t);$("div.background_overlay").clearQueue();$("div.background_overlay").stop();$("div.background_overlay").animate({opacity:1},1e3);$("div.footer").empty();s=true;var n=$(".center .typeahead").val();if(m[n.toLowerCase()]!=1){n=u}else{u=n.toLowerCase();a=n}$.getJSON("http://api.flickr.com/services/rest/?method=flickr.photos.search&nojsoncallback=1",{api_key:e,tags:n,tagmode:"any",format:"json",safe_search:"1",is_getty:"1",page:p,extras:"owner_name, license"}).done(function(e){if(e.photos.photo.length==0){$(".center .typeahead").val(h[Math.floor(Math.random()*(h.length-1))]);b()}else{r=e.photos.photo.slice(0);p=e.photos.page;d=e.photos.pages;i=0;console.log("Number of photos: "+e.photos.photo.length);w()}})}function w(){$("div.page").clearQueue();$("div.page").dequeue();if(i<r.length){y(r[i].id,i);i+=1;if(s==false&&i<r.length){g(r[i].id,i)}if(i==1){t=setTimeout(function(){w()},6e3)}if(i==2){t=setInterval(function(){w()},2e4)}}else{p+=1;if(p>d){i=1}b()}}function E(){var e=$(".center .typeahead").val();$("div.error").clearQueue();$("div.error").queue(function(){$("div.error").empty();$("div.error").animate({opacity:0},1e3,function(){});$("div.error").dequeue()});if(m[e.toLowerCase()]==1&&u!=e.toLowerCase()){clearTimeout(n);console.log("Found city: "+e);var t=jQuery.Event("keydown",{keyCode:27});$(".center .typeahead").trigger(t);$("div.page").queue(function(){b()});return}if(u==e.toLowerCase()){var t=jQuery.Event("keydown",{keyCode:27});$(".center .typeahead").trigger(t)}console.log("Didn't find city: "+e)}function S(){f=1;$("div.page").css("cursor","none");$("div.content").css("z-index","-100");$("div.center").css("z-index","-100");$("div.center_button").css("z-index","-100");$("div.footer").css("z-index","-100");$("div.error").css("z-index","-100");$("input.typeahead").blur()}function x(){f=0;$("div.content").css("z-index","2");$("div.center").css("z-index","2");$("div.center_button").css("z-index","1");$("div.footer").css("z-index","2");$("div.error").css("z-index","2")}function T(){$("div.page").css("cursor","default");clearTimeout(l);if(f==1){if(u!=o){$(".center .typeahead").typeahead("setQuery",a);$("div.error").empty()}$("div.content").animate({opacity:1},1e3,function(){x()})}if(c==0){l=setTimeout(function(){$("div.content").animate({opacity:0},1e3,function(){S()})},3e3)}}function N(){if(c==1){var e=$("div.page").width();var t=$("div.page").height();$("div.stats").empty();$("div.stats").append('<p class="stats">Height:'+t+"</p>");$("div.stats").append('<p class="stats">Width:'+e+"</p>")}}function C(){$("div.stats").empty();$("div.mousestats").empty()}function k(){var e=$("div.page").width();var t=$("div.page").height();var n=t*.25;n=n+"px";var r=e/2-$("p.error").width()/2;r=r+"px";$("div.error").css("top",n);$("div.error").css("left",r)}function L(){var e=$("div.page").width();var t=$("div.page").height();N();var n=$(".center .typeahead").width();var r=$("#random_button").width();var i=$("#attributes").width();var s=t*.41;s=s+"px";var o=e/2-$("div.center").width()/2;o=o+"px";var u=t*.61;u=u+"px";var a=e/2-$("div.center_button").width()/2;a=a+"px";var f=t*.92;f=f+"px";var l=e/2-$("div.footer").width()/2;l=l+"px";var h=t*.25;h=h+"px";var p=e/2-$("div.error").width()/2;p=p+"px";$("div.center").css("top",s);$("div.center").css("left",o);$("div.center_button").css("top",u);$("div.center_button").css("left",a);$("div.footer").css("top",f);$("div.footer").css("left",l);$("div.error").css("top",h);$("div.error").css("left",p);if(c==1){console.log("===========================");console.log("New pageWidth: "+e);console.log("New pageHeight: "+t);console.log("centerTop:  "+s);console.log("centerLeft:  "+o);console.log("centerButtonTop:  "+u);console.log("centerButtonLeft:  "+a);console.log("footerTop:  "+f);console.log("footerLeft:  "+l)}}function A(){var e=$(".center .typeahead").val();if(m[e.toLowerCase()]!=1){$("div.error").empty();$("div.error").append('<p class="error"><b>Unknown city: '+e+"</b></p>");k();$("div.error").animate({opacity:1},1e3,function(){});clearTimeout(l);l=setTimeout(function(){$("div.content").animate({opacity:0},1e3,function(){S()})},6e3)}}var e="d7be36810508e06056c914d4182394f7";var t;var n=null;var r;var i=0;var s=true;var o="city";var u=o;var a;var f=1;var l=null;var c=0;var h=["Amsterdam","Athens","Atlantic City","Baltimore","Bangalore","Bangkok","Barcelona","Beijing","Berlin","Bern","Boston","Brussels","Budapest","Buenos Aires","Cairo","Canberra","Cannes","Cape Town","Chicago","Cinque Terre","Cologne","Copenhagen","Damascus","Delhi","Dubai City","Dublin","Dubrovnik","England","Florence","Ha Noi","Havana","Helsinki","Hong Kong","Honolulu","Istanbul","Jakarta","Jerusalem","Kailua","Kansas City","Kathmandu","Kuala Lumpur","Lisbon","London","Los Angeles","Luxembourg","Madrid","Marseille","Manila","Melbourne","Mexico City","Milan","Montreal","Moravia","Moscow","Mumbai","Munich","Nazareth","New York","Oia","Osaka","Ottawa","Oslo","Paris","Penang","Philadelphia","Phnom Penh","Prague","Quito","Reykjavik","Rio de Janeiro","Rome","San Francisco","San Jose","Santa Fe","Santiago","Sao Paulo","Shanghai","Singapore City","Stockholm","Saint-Petersburg","Sydney","Taipei","Tehachapi","Tokyo","Toronto","Vatican City","Venice","Vienna","Washington D.C.","Zurich"];var p=1;var d;var v;var m={};m["amsterdam"]=1;m["athens"]=1;m["atlantic city"]=1;m["baltimore"]=1;m["bangalore"]=1;m["bangkok"]=1;m["barcelona"]=1;m["bern"]=1;m["beijing"]=1;m["berlin"]=1;m["boston"]=1;m["brussels"]=1;m["budapest"]=1;m["buenos aires"]=1;m["cairo"]=1;m["canberra"]=1;m["cannes"]=1;m["cape town"]=1;m["chicago"]=1;m["cinque terre"]=1;m["cologne"]=1;m["copenhagen"]=1;m["damascus"]=1;m["delhi"]=1;m["dubai city"]=1;m["dublin"]=1;m["dubrovnik"]=1;m["england"]=1;m["florence"]=1;m["ha noi"]=1;m["havana"]=1;m["helsinki"]=1;m["hong kong"]=1;m["honolulu"]=1;m["istanbul"]=1;m["jakarta"]=1;m["jerusalem"]=1;m["kailua"]=1;m["kansas city"]=1;m["kathmandu"]=1;m["kuala lumpur"]=1;m["lisbon"]=1;m["london"]=1;m["los angeles"]=1;m["luxembourg"]=1;m["madrid"]=1;m["manila"]=1;m["marseille"]=1;m["melbourne"]=1;m["mexico city"]=1;m["milan"]=1;m["montreal"]=1;m["moravia"]=1;m["moscow"]=1;m["mumbai"]=1;m["munich"]=1;m["nazareth"]=1;m["new york"]=1;m["oia"]=1;m["osaka"]=1;m["ottawa"]=1;m["oslo"]=1;m["paris"]=1;m["penang"]=1;m["philadelphia"]=1;m["phnom penh"]=1;m["prague"]=1;m["quito"]=1;m["reykjavik"]=1;m["rio de janeiro"]=1;m["rome"]=1;m["san francisco"]=1;m["san jose"]=1;m["santa fe"]=1;m["santiago"]=1;m["sao paulo"]=1;m["shanghai"]=1;m["singapore city"]=1;m["stockholm"]=1;m["saint-petersburg"]=1;m["sydney"]=1;m["taipei"]=1;m["tehachapi"]=1;m["tokyo"]=1;m["toronto"]=1;m["vatican city"]=1;m["venice"]=1;m["vienna"]=1;m["washington d.c."]=1;m["zurich"]=1;L();b();if(c==1){N()}else{C()}$(".center .typeahead").typeahead({name:"cities",local:h});$(".center .typeahead").keyup(function(){E()});$(".center").click(function(){E()});$("#random_button").click(function(){$(".center .typeahead").typeahead("setQuery",h[Math.floor(Math.random()*(h.length-1))]);$(".center .typeahead").keyup()});$("#next_image_button").click(function(){clearTimeout(t);$("div.background_overlay").clearQueue();$("div.background_overlay").stop();$("div.background_overlay").animate({opacity:1},100);$("div.background").css("background-image","");$("div.footer").empty();s=true;w();t=setInterval(function(){w()},6e3)});$("div.page").click(function(){T()});$("div.page").mouseover(function(){T()});$("div.page").keyup(function(){T();var e=$(".center .typeahead").val();if(e.length>0){clearTimeout(n);n=setTimeout(function(){A()},2e3)}});$(window).resize(function(){$("div.resizer").queue(function(){L();$("div.resizer").dequeue()})});if(c==1){$(window).mousemove(function(e){var t="( "+e.pageX+", "+e.pageY+" )";var n="( "+e.clientX+", "+e.clientY+" )";$("div.mousestats").empty();$("div.mousestats").append('<p class="stats">'+t+"</p>");$("div.mousestats").append('<p class="stats">'+n+"</p>")})}})
</script>
</html> 
