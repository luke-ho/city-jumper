<!DOCTYPE html>
<html>
<head>
    <title>City Jumper</title>
    <link rel="shortcut icon" href="img/city_jumper.ico"/>
    <style>
        html{font-family:"Helvetica Neue";font-size:16px}
        div.background{background-color:#000;opacity:1;width:100%;height:auto;bottom:0;top:0;left:0;z-index:-99;position:absolute;background-attachment:fixed;background-position:center;background-repeat:no-repeat}
        div.background_overlay{background-color:#000;opacity:0;width:100%;height:auto;bottom:0;top:0;left:0;position:absolute;z-index:-50}
        div.error{position:absolute;opacity:0;top:25%;left:28%;z-index:2}
        div.page{background-color:transparent;opacity:1;width:100%;height:auto;bottom:0;top:0;left:0;position:absolute;background-attachment:fixed;background-position:center;background-repeat:no-repeat}
        div.center{position:absolute;top:41%;left:38%;z-index:2}
        div.center_button{position:absolute;top:61%;left:47.6%;z-index:1}
        div.footer{position:absolute;top:92%;left:28%;z-index:2}
        div.pagestats{position:absolute;top:20%;left:48%}
        div.mousestats{position:absolute;top:20%;left:47%}
        p.error{color:red;text-align:center}
        p.stats,a.attributes{color:#DDE3f4;text-align:center}
    </style>
    <style>
        .typeahead,.tt-query,.tt-hint{width:300px;height:30px;font-size:24px;line-height:30px;border:2px solid #ccc;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;outline:none;color:#fff;padding:8px 12px}
        .typeahead{background-color:transparent}
        .typeahead:focus{border:2px solid #0097cf}
        .tt-query{-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);-moz-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}
        .tt-hint{color:#999}
        .tt-dropdown-menu{width:300px;margin-top:12px;background-color:#000;border:1px solid rgba(0,0,0,0.2);-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;-webkit-box-shadow:0 5px 10px rgba(0,0,0,.2);-moz-box-shadow:0 5px 10px rgba(0,0,0,.2);box-shadow:0 5px 10px rgba(0,0,0,.2);padding:8px 12px}
        .tt-suggestion{font-size:18px;line-height:24px;color:#DDE3f4;padding:3px 20px}
        .tt-suggestion.tt-is-under-cursor{color:#fff;background-color:#0097cf}
        .tt-suggestion p{margin:0}
        .gist{font-size:14px}
    </style>
</head>
<body>  
    <div class="background"></div> 
    <div class="background_overlay"></div>
    <div class="resizer"></div>
    <div class="page">
        <noscript> Enable JavaScript to see the content on this page.</noscript>
        <div class="content">
            <div class="stats">
            </div>
            <div class="error">
            </div>
            <div class="mousestats">
            </div>
            <div class="center">
                <input class="typeahead" type="text" placeholder="City?">
            </div>
            <div class="center_button">
                <button id="random_button" type="button">Pick for Me!</button>
                <button id="next_image_button" type="button">Next Image</button>
            </div>
            <div class="footer">
            </div>
        </div>    
    </div>
</body>
<script src="js/jquery.min.js"></script>
<script src="js/typeahead.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){function y(t,n){var r=$("div.page").width();var i=$("div.page").height();var s=0;$.getJSON("http://api.flickr.com/services/rest/?method=flickr.photos.getSizes&nojsoncallback=1",{api_key:e,photo_id:t,format:"json"}).done(function(e){var t=e.sizes.size.length-1;s=e.sizes.size[e.sizes.size.length-1].source;v=new Image;v.src=s})}function b(t,n){var r=$("div.page").width();var i=$("div.page").height();var o=0;$.getJSON("http://api.flickr.com/services/rest/?method=flickr.photos.getSizes&nojsoncallback=1",{api_key:e,photo_id:t,format:"json"}).done(function(e){var t=e.sizes.size.length-1;o=e.sizes.size[e.sizes.size.length-1].source;if(s==false){$("div.background_overlay").animate({opacity:1},1e4,function(){$("div.background").css("background-image","url("+o+")");$("div.footer").empty();$("div.footer").append('<a href="'+e.sizes.size[t].url+'" target="_blank" class="attributes">'+e.sizes.size[t].url+"</a>");A()});$("div.background_overlay").animate({opacity:0},1e4,function(){})}else{$("div.background").css("background-image","url("+o+")");$("div.background_overlay").animate({opacity:0},2e3);$("div.footer").empty();$("div.footer").append('<a href="'+e.sizes.size[t].url+'" target="_blank" class="attributes">'+e.sizes.size[t].url+"</a>");A();s=false}})}function w(){clearTimeout(t);$("div.background_overlay").clearQueue();$("div.background_overlay").stop();$("div.background_overlay").animate({opacity:1},1e3);$("div.footer").empty();s=true;p=1;var n=$(".center .typeahead").val();if(m[n.toLowerCase()]!=1){n=u}else{u=n.toLowerCase();a=n}$.getJSON("http://api.flickr.com/services/rest/?method=flickr.photos.search&nojsoncallback=1",{api_key:e,tags:n,tagmode:"any",format:"json",safe_search:"1",is_getty:"1",page:p,extras:"owner_name, license"}).done(function(e){if(e.photos.photo.length==0){$(".center .typeahead").val(h[Math.floor(Math.random()*(h.length-1))]);w()}else{r=e.photos.photo.slice(0);p=e.photos.page;d=e.photos.pages;i=0;console.log("Number of photos: "+e.photos.photo.length);E()}})}function E(){$("div.page").clearQueue();$("div.page").dequeue();if(i<r.length){b(r[i].id,i);i+=1;if(s==false&&i<r.length){y(r[i].id,i)}if(i==1){t=setTimeout(function(){E()},6e3)}if(i==2){t=setInterval(function(){E()},2e4)}}else{p+=1;if(p>d){i=1;p=1}w()}}function S(){var e=$(".center .typeahead").val();$("div.error").clearQueue();$("div.error").queue(function(){$("div.error").empty();$("div.error").animate({opacity:0},1e3,function(){});$("div.error").dequeue()});if(m[e.toLowerCase()]==1&&u!=e.toLowerCase()){clearTimeout(n);console.log("Found city: "+e);var t=jQuery.Event("keydown",{keyCode:27});$(".center .typeahead").trigger(t);$("div.page").queue(function(){w()});return}if(u==e.toLowerCase()){var t=jQuery.Event("keydown",{keyCode:27});$(".center .typeahead").trigger(t)}console.log("Didn't find city: "+e.toLowerCase()+", oldCity: "+u)}function x(){f=1;$("div.page").css("cursor","none");$("div.content").css("z-index","-100");$("div.center").css("z-index","-100");$("div.center_button").css("z-index","-100");$("div.footer").css("z-index","-100");$("div.error").css("z-index","-100");$("input.typeahead").blur()}function T(){f=0;$("div.content").css("z-index","2");$("div.center").css("z-index","2");$("div.center_button").css("z-index","1");$("div.footer").css("z-index","2");$("div.error").css("z-index","2")}function N(){$("div.page").css("cursor","default");clearTimeout(l);if(f==1){if(u!=o){$(".center .typeahead").typeahead("setQuery",a);$("div.error").empty()}$("div.content").animate({opacity:1},1e3,function(){T()})}if(c==0){l=setTimeout(function(){$("div.content").animate({opacity:0},1e3,function(){x()})},3e3)}}function C(){if(c==1){var e=$("div.page").width();var t=$("div.page").height();$("div.stats").empty();$("div.stats").append('<p class="stats">Height:'+t+"</p>");$("div.stats").append('<p class="stats">Width:'+e+"</p>")}}function k(){$("div.stats").empty();$("div.mousestats").empty()}function L(){var e=$("div.page").width();var t=$("div.page").height();var n=t*.25;n=n+"px";var r=e/2-$("p.error").width()/2;r=r+"px";$("div.error").css("top",n);$("div.error").css("left",r)}function A(){var e=$("div.page").width();var t=$("div.page").height();C();var n=$(".center .typeahead").width();var r=$("#random_button").width();var i=$("#attributes").width();var s=t*.41;s=s+"px";var o=e/2-$("div.center").width()/2;o=o+"px";var u=t*.61;u=u+"px";var a=e/2-$("div.center_button").width()/2;a=a+"px";var f=t*.92;f=f+"px";var l=e/2-$("div.footer").width()/2;l=l+"px";var h=t*.25;h=h+"px";var p=e/2-$("div.error").width()/2;p=p+"px";$("div.center").css("top",s);$("div.center").css("left",o);$("div.center_button").css("top",u);$("div.center_button").css("left",a);$("div.footer").css("top",f);$("div.footer").css("left",l);$("div.error").css("top",h);$("div.error").css("left",p);if(c==1){console.log("===========================");console.log("New pageWidth: "+e);console.log("New pageHeight: "+t);console.log("centerTop:  "+s);console.log("centerLeft:  "+o);console.log("centerButtonTop:  "+u);console.log("centerButtonLeft:  "+a);console.log("footerTop:  "+f);console.log("footerLeft:  "+l)}}function O(){var e=$(".center .typeahead").val();if(m[e.toLowerCase()]!=1){$("div.error").empty();$("div.error").append('<p class="error"><b>Unknown city: '+e+"</b></p>");L();$("div.error").animate({opacity:1},1e3,function(){});clearTimeout(l);l=setTimeout(function(){$("div.content").animate({opacity:0},1e3,function(){x()})},6e3)}}var e="d7be36810508e06056c914d4182394f7";var t;var n=null;var r;var i=0;var s=true;var o="city";var u=o;var a;var f=1;var l=null;var c=0;var h=["Adelaide","Algiers","Alice Springs","Amman","Amsterdam","Astana","Athens","Atlanta","Atlantic City","Bali","Baltimore","Bangalore","Bangkok","Barcelona","Beijing","Beirut","Bergen","Berlin","Bern","Boston","Bremen","Brisbane","Brussels","Budapest","Buenos Aires","Bulawayo","Cairns","Cairo","Canberra","Cannes","Cape Town","Caracas","Cartagena","Chengdu","Chicago","Chihuahua","Cinque Terre","Cologne","Colombo","Copenhagen","Damascus","Delhi","Dubai City","Dublin","Dubrovnik","Edinburgh","Edmonton","Essaouira","Florence","Gothenburg","Grahamstown","Guangzhou","Guadalajara","Hamburg","Ha Noi","Havana","Helsinki","Hilo","Hong Kong","Honolulu","Hyderabad","Istanbul","Jakarta","Jerusalem","Kahului","Kailua","Kaneohe","Kathmandu","Khartoum","Kuala Lumpur","Kumasi","Lamu","Las Vegas","Lima","Lisbon","Liverpool","London","Los Angeles","Luxembourg","Luxor","Macau","Madrid","Managua","Manchester","Marrakech","Marseille","Manila","Melbourne","Mexico City","Milan","Minsk","Montreal","Moravia","Moscow","Mumbai","Munich","Naples","Nazareth","New York City","Oia","Orlando","Osaka","Ottawa","Oslo","Palma de Mallorca","Paris","Penang","Perth","Philadelphia","Phnom Penh","Prague","Quito","Reykjavik","Rio de Janeiro","Rome","Salvador","San Francisco","San Jose","San Juan","Santa Fe","Santiago","Sao Paulo","Seoul","Shanghai","Singapore City","Stockholm","Saint-Petersburg","Sydney","Taipei","Tangier","Tehachapi","Tehran","Tokyo","Toronto","Vancouver","Vatican City","Venice","Vienna","Voronezh","Warsaw","Washington D.C.","Wuhan","Xi'An","Zagreb","Zurich"];var p=1;var d;var v;var m={};for(var g=0;g<h.length;g++){m[h[g].toLowerCase()]=1}A();w();if(c==1){C()}else{k()}$(".center .typeahead").typeahead({name:"cities",local:h});$(".center .typeahead").keyup(function(e){if(e.keyCode!=38&&e.keyCode!=40){S()}});$(".center .typeahead").click(function(){S()});$(".tt-dropdown-menu").click(function(){S()});$("#random_button").click(function(){$(".center .typeahead").typeahead("setQuery",h[Math.floor(Math.random()*(h.length-1))]);$(".center .typeahead").keyup()});$("#next_image_button").click(function(){clearTimeout(t);$("div.background_overlay").clearQueue();$("div.background_overlay").stop();$("div.background_overlay").animate({opacity:1},100);$("div.background").css("background-image","");$("div.footer").empty();s=true;E();t=setInterval(function(){E()},6e3)});$("div.page").click(function(){N()});$("div.page").mouseover(function(){N()});$("div.page").keyup(function(){N();var e=$(".center .typeahead").val();if(e.length>0){clearTimeout(n);n=setTimeout(function(){O()},2e3)}});$(window).resize(function(){$("div.resizer").queue(function(){A();$("div.resizer").dequeue()})});if(c==1){$(window).mousemove(function(e){var t="( "+e.pageX+", "+e.pageY+" )";var n="( "+e.clientX+", "+e.clientY+" )";$("div.mousestats").empty();$("div.mousestats").append('<p class="stats">'+t+"</p>");$("div.mousestats").append('<p class="stats">'+n+"</p>")})}})
</script>
</html> 
